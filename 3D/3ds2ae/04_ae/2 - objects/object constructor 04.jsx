// functions
	function isClass(obj,str){
		return obj.constructor.name==str
		}

	function isArray(obj){
		//return (typeof obj=="object" && obj.unshift!=undefined)
		return obj.constructor.name=="Array"
		}

// constructors
	function KeyArray(t,v){
		this.t=t
		this.v=v
		return this
		}

	function AEObject(
		name,w,h,
		pos,rot,sca,poi,opa
		){
			this.name=name
			this.width=w
			this.height=h
	
			this.transform=new Object()
			this.transform.position=pos
			this.transform.rotation=rot
			this.transform.scale=sca
			this.transform.pointOfInterest=poi
			this.transform.opacity=opa
/*
			this.property=new Object()
			this.property.FielfOfView=fov
			this.effects=new Object()
			this.material=new Object()
*/
			return this
			}

// variables
	var objArr=new Array()
	var errArr=new Array()
	var comp=app.project.activeItem

// declarations	
	var obj= new AEObject(
				"Camera 1", 30, 100,
				new KeyArray(
					[0.0,0.4,0.8,1.2,1.6,2.0,2.4,2.8,3.2,3.6,4.0],
					[[-198.84,210.03,-245.83],[-198.78,158.71,-237.18],[-198.56,36.32,-216.55],[-198.09,-109.75,-191.92],[-197.32,-232.13,-171.29],[-196.16,-283.45,-162.63],[-156.94,-236.48,-170.2],[-65.4,-124.46,-188.25],[43.41,9.23,-209.79],[134.41,121.25,-227.84],[172.54,168.22,-235.41]]
					),
				0,
				[100,100,100],
				new KeyArray(
					[0.0,0.04,0.08,0.12,0.16,0.2,0.24,0.28,0.32,0.36,0.4,0.44,0.48,0.52,0.56,0.6,0.64,0.68,0.72,0.76,0.8,0.84,0.88,0.92,0.96,1.0,1.04,1.08,1.12,1.16,1.2,1.24,1.28,1.32,1.36,1.4,1.44,1.48,1.52,1.56,1.6,1.64,1.68,1.72,1.76,1.8,1.84,1.88,1.92,1.96,2.0,2.04,2.08,2.12,2.16,2.2,2.24,2.28,2.32,2.36,2.4,2.44,2.48,2.52,2.56,2.6,2.64,2.68,2.72,2.76,2.8,2.84,2.88,2.92,2.96,3.0,3.04,3.08,3.12,3.16,3.2,3.24,3.28,3.32,3.36,3.4,3.44,3.48,3.52,3.56,3.6,3.64,3.68,3.72,3.76,3.8,3.84,3.88,3.92,3.96,4.0],
					[[-19.66,-1.84,-2.09],[-19.64,-1.84,-2.08],[-19.61,-1.83,-2.04],[-19.55,-1.83,-1.97],[-19.46,-1.82,-1.87],[-19.36,-1.81,-1.75],[-19.23,-1.8,-1.61],[-19.09,-1.78,-1.45],[-18.93,-1.77,-1.26],[-18.74,-1.75,-1.06],[-18.55,-1.73,-0.83],[-18.34,-1.71,-0.59],[-18.11,-1.69,-0.33],[-17.87,-1.67,-0.06],[-17.62,-1.64,0.23],[-17.35,-1.62,0.53],[-17.08,-1.59,0.84],[-16.8,-1.56,1.16],[-16.5,-1.54,1.49],[-16.21,-1.51,1.83],[-15.9,-1.48,2.18],[-15.59,-1.45,2.53],[-15.28,-1.42,2.89],[-14.96,-1.39,3.25],[-14.64,-1.36,3.61],[-14.32,-1.33,3.97],[-14.0,-1.3,4.34],[-13.68,-1.27,4.7],[-13.37,-1.24,5.06],[-13.05,-1.21,5.42],[-12.74,-1.18,5.77],[-12.44,-1.15,6.11],[-12.14,-1.12,6.45],[-11.85,-1.09,6.78],[-11.57,-1.07,7.11],[-11.29,-1.04,7.42],[-11.03,-1.02,7.72],[-10.78,-0.99,8.0],[-10.54,-0.97,8.28],[-10.31,-0.95,8.53],[-10.1,-0.93,8.78],[-9.9,-0.91,9.0],[-9.72,-0.89,9.21],[-9.56,-0.88,9.39],[-9.41,-0.86,9.56],[-9.29,-0.85,9.7],[-9.18,-0.84,9.82],[-9.1,-0.83,9.91],[-9.04,-0.83,9.98],[-9.0,-0.82,10.02],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04],[-8.99,-0.82,10.04]]
					),
				100
				)
	objArr.push(obj)

// main loop
	for (obj in objArr){
		var obj=objArr[obj]
		var layer=comp.layers.byName(obj.name)
		if(layer){
			for(prop in obj.transform){
				var val=obj.transform[prop]
				//alert(prop)
				//alert(obj.transform[d])
				try{
					if(isClass(obj.transform[prop],"KeyArray")){
						var t=obj.transform[prop].t
						var v=obj.transform[prop].v
						layer[prop].setValuesAtTimes(t,v)
						}
					else{
						var v=obj.transform[prop]
						layer[prop].setValue(v)
						}
					}
				catch(err){
					}
				}
			}
		else errArr.push(obj.name)
		}

	
	
// missing objects
	if(errArr.length>0){
		alert("The following named objects from 3dsmax did not update correctly in After Effects because they could not be found:\n\n"+errArr.toString()+"\n\nRename them correctly in one (or both) of the applications and try again.")
		}
