// functions
	function isClass(obj,str){
		return obj.constructor.name==str
		}

	function isArray(obj){
		//return (typeof obj=="object" && obj.unshift!=undefined)
		return obj.constructor.name=="Array"
		}

// constructors
	function KeyArray(t,v){
		this.t=t
		this.v=v
		return this
		}

	function Solid(
		name,w,h,
		pos,rot,sca,opa
		){
			this.name=name
			this.width=w
			this.height=h
	
			this.transform=new Object()
			this.transform.position=pos
			this.transform.rotation=rot
			this.transform.scale=sca
			this.transform.opacity=opa
/*
			this.property=new Object()
			this.property.FielfOfView=fov
			this.effects=new Object()
			this.material=new Object()
*/
			return this
			}

// variables
	var objArr=new Array()
	var errArr=new Array()
	var comp=app.project.activeItem

// declarations	
	var obj= new Solid(
				"Solid", 30, 100,
				new KeyArray(
				/*
					[0,1,2,3,4,5],
					[
						[-198.84,-245.83,-210.03],
						[-198.84,-245.73,-209.44],
						[-198.84,-245.44,-207.72],
						[-198.84,-244.97,-204.91],
						[-198.84,-244.32,-201.06],
						[-198.83,-243.5,-196.21]
					]
					*/
					[0.0,0.04,0.08,0.12,0.16,0.2,0.24,0.28,0.32,0.36,0.4,0.44,0.48,0.52,0.56,0.6,0.64,0.68,0.72,0.76,0.8,0.84,0.88,0.92,0.96,1.0,1.04,1.08,1.12,1.16,1.2,1.24,1.28,1.32,1.36,1.4,1.44,1.48,1.52,1.56,1.6,1.64,1.68,1.72,1.76,1.8,1.84,1.88,1.92,1.96,2.0,2.04,2.08,2.12,2.16,2.2,2.24,2.28,2.32,2.36,2.4,2.44,2.48,2.52,2.56,2.6,2.64,2.68,2.72,2.76,2.8,2.84,2.88,2.92,2.96,3.0,3.04,3.08,3.12,3.16,3.2,3.24,3.28,3.32,3.36,3.4,3.44,3.48,3.52,3.56,3.6,3.64,3.68,3.72,3.76,3.8,3.84,3.88,3.92,3.96,4.0],
					[
					[-198.84,-245.83,-210.03],[-198.84,-245.73,-209.44],[-198.84,-245.44,-207.72],[-198.84,-244.97,-204.91],[-198.84,-244.32,-201.06],[-198.83,-243.5,-196.21],[-198.82,-242.52,-190.41],[-198.82,-241.4,-183.72],[-198.81,-240.12,-176.17],[-198.8,-238.71,-167.82],[-198.78,-237.18,-158.71],[-198.77,-235.52,-148.88],[-198.75,-233.76,-138.4],[-198.74,-231.88,-127.3],[-198.72,-229.92,-115.63],[-198.7,-227.86,-103.44],[-198.67,-225.73,-90.77],[-198.65,-223.52,-77.68],[-198.62,-221.25,-64.21],[-198.59,-218.92,-50.41],[-198.56,-216.55,-36.32],[-198.52,-214.13,-22.0],[-198.48,-211.68,-7.49],[-198.45,-209.21,7.17],[-198.4,-206.73,21.92],[-198.36,-204.23,36.71],[-198.31,-201.74,51.51],[-198.26,-199.25,66.26],[-198.21,-196.78,80.91],[-198.15,-194.33,95.43],[-198.09,-191.92,109.75],[-198.03,-189.54,123.83],[-197.96,-187.22,137.64],[-197.89,-184.95,151.11],[-197.82,-182.74,164.2],[-197.75,-180.6,176.86],[-197.67,-178.55,189.05],[-197.59,-176.58,200.72],[-197.5,-174.71,211.82],[-197.41,-172.94,222.31],[-197.32,-171.29,232.13],[-197.22,-169.75,241.24],[-197.12,-168.34,249.6],[-197.01,-167.07,257.14],[-196.91,-165.94,263.84],[-196.79,-164.96,269.64],[-196.68,-164.15,274.48],[-196.55,-163.5,278.34],[-196.43,-163.02,281.15],[-196.3,-162.73,282.87],[-196.16,-162.63,283.45],[-195.6,-162.72,282.92],[-194.19,-162.97,281.34],[-191.98,-163.39,278.77],[-189.0,-163.96,275.24],[-185.29,-164.67,270.81],[-180.88,-165.53,265.5],[-175.8,-166.51,259.37],[-170.1,-167.63,252.46],[-163.8,-168.86,244.82],[-156.94,-170.2,236.48],[-149.57,-171.65,227.49],[-141.7,-173.2,217.89],[-133.38,-174.83,207.73],[-124.64,-176.56,197.05],[-115.52,-178.35,185.89],[-106.05,-180.22,174.3],[-96.27,-182.15,162.32],[-86.21,-184.14,149.99],[-75.91,-186.17,137.36],[-65.4,-188.25,124.46],[-54.71,-190.36,111.35],[-43.89,-192.5,98.07],[-32.97,-194.67,84.66],[-21.98,-196.84,71.16],[-10.96,-199.02,57.62],[0.06,-201.2,44.07],[11.04,-203.38,30.57],[21.95,-205.54,17.16],[32.75,-207.68,3.88],[43.41,-209.79,-9.23],[53.89,-211.87,-22.12],[64.16,-213.91,-34.76],[74.18,-215.89,-47.09],[83.91,-217.82,-59.07],[93.33,-219.69,-70.66],[102.39,-221.49,-81.82],[111.07,-223.21,-92.5],[119.32,-224.85,-102.66],[127.11,-226.39,-112.26],[134.41,-227.84,-121.25],[141.18,-229.19,-129.59],[147.39,-230.42,-137.23],[153.0,-231.53,-144.14],[157.97,-232.52,-150.27],[162.28,-233.37,-155.57],[165.88,-234.09,-160.01],[168.74,-234.66,-163.54],[170.83,-235.07,-166.11],[172.11,-235.33,-167.69],[172.54,-235.41,-168.22]
					]
	
					),
				45,
				[100,100,100],
				100
				)
	objArr.push(obj)

// main loop
	for (obj in objArr){
		var obj=objArr[obj]
		var layer=comp.layers.byName(obj.name)
		if(layer){
			for(prop in obj.transform){
				var val=obj.transform[prop]
				//alert(prop)
				//alert(obj.transform[d])
				if(isClass(obj.transform[prop],"KeyArray")){
					var t=obj.transform[prop].t
					var v=obj.transform[prop].v
					layer[prop].setValuesAtTimes(t,v)
					}
				else{
					var v=obj.transform[prop]
					layer[prop].setValue(v)
					}
				}
			}
		else errArr.push(obj.name)
		}

	
	
// missing objects
	if(errArr.length>0){
		alert("The following named objects from 3dsmax did not update correctly in After Effects because they could not be found:\n\n"+errArr.toString()+"\n\nRename them correctly in one (or both) of the applications and try again.")
		}
